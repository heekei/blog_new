(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{220:function(s,n,e){"use strict";e.r(n);var t=e(2),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"asp-net-自定义服务器控件的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#asp-net-自定义服务器控件的使用"}},[s._v("#")]),s._v(" ASP.NET 自定义服务器控件的使用")]),s._v(" "),e("p",[s._v("最近在做一个网站后台，想要用")]),s._v(" "),e("blockquote",[e("p",[s._v("<xxx:xxx />")])]),s._v(" "),e("p",[s._v("这种形式来直接读取数据库的数据，于是研究了一下自定义服务器控件。\n首先，先新建一个WebCustomControl1类（WEB自定义服务器控件）\nVS默认生成的代码如下：\n")]),s._v(" "),e("div",{staticClass:"language-using System; line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    using System.Collections.Generic;\n    using System.ComponentModel;\n    using System.Linq;\n    using System.Text;\n    using System.Threading.Tasks;\n    using System.Web;\n    using System.Web.UI;\n    using System.Web.UI.WebControls;\n\n    namespace UniversalWebSiteBg \n    {\n        //是设置控件默认的属性的。这里是其Text属性。就是当你选择这个控件的时候，在属性窗口中自动被选中的是Text属性。\n        [DefaultProperty("Text")] \n        //这行表示，当你在工具箱拖动自定义服务器控件时，为它生成的默认标记\n        [ToolboxData("&lt;{0}:WebCustomControl1 runat=server&gt;&lt;/{0}:WebCustomControl1&gt;")]\n        public class WebCustomControl1 : WebControl\n        {\n            // "Text"是这个服务器控件的一个属性\n            [Bindable(true)] //指定是否通常用于绑定\n            [Category("Appearance")] //说明该属性的分类是“外观”\n            [DefaultValue("")]//默认值为空\n            [Localizable(true)]//指定是否应本地化该属性\n            public string Text\n            {\n                get\n                {\n                    String s = (String)ViewState["Text"];\n                    return ((s == null) ? String.Empty : s);\n                }\n\n                set\n                {\n                    ViewState["Text"] = value;\n                }\n            }\n\n            //返回输出服务器控件在网页上所显示的值。\n            //默认的输出结构是：&lt;span&gt;这里是输出的值&lt;/span&gt;\n            //到这里，可能和我一样的初学者会问了，为什么默认输出的是span标记？为什么不能是a标记，为什么不能是单纯的文本？\n            //这里就说到了控件的渲染方法RenderContents了，VS默认是使用RenderContents方法,这样的话输出的是span标记也是固定了\n            //如果想输出单纯文本的话，那么就应该是使用Render，而不是RenderContents了。\n            protected override void RenderContents(HtmlTextWriter output)\n            {\n                output.Write(Text);\n            }\n        }\n    }\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br")])]),e("p",[s._v("于是，我们将改动一下默认的渲染方法：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("protected override void Render(HtmlTextWriter output)\n{\n     output.Write(Text);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("这样的话，控件输出的内容就不包含标记了。\n那么，如何输出其他的标记呢？")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('protected override void Render(HtmlTextWriter output)\n{\n    output.WriteBeginTag("a");//输出标记的开头\n    output.Write("这是一个标记");//输出标记的内容\n    output.WriteEndTag("a");//输出标记的结束符\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("这样运行的话，你会发现，html源码如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<a>这是一个标记</a>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("到这里，控件的构建就完成了，但是，你要在ASPX页面中去使用它，还需要在前台页面注册它，表明它的命名空间，标记前缀等信息。\n回到开头那里的")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[ToolboxData("<{0}:WebCustomControl1 runat=server></{0}:WebCustomControl1>")]\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("pre",[e("code",[s._v("{0}这个就是标记前缀字段\n")])]),s._v(" "),e("div",{staticClass:"language-//在前台页面重要写出： line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    <%@ Register Assembly="UniversalWebSiteBg" Namespace="UniversalWebSiteBg" TagPrefix="UniBg" %>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("在这里，我写的标记前缀是  UniBg\n于是，我在工具箱中拖动控件到页面中后，\n会生成标记：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<UniBg:WebCustomControl1 Id="WebCustomControl1" Text="" runat="server" />\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("于是这个简单的服务器控件就完成了。")])])}),[],!1,null,null,null);n.default=a.exports}}]);